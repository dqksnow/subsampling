<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Optimal Subsampling Methods for Generalized Linear Models — ssp.glm • subsampling</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Optimal Subsampling Methods for Generalized Linear Models — ssp.glm"><meta name="description" content="Draw subsample from full dataset and fit a generalized linear model (GLM) on the subsample. For a quick start, refer to the vignette."><meta property="og:description" content="Draw subsample from full dataset and fit a generalized linear model (GLM) on the subsample. For a quick start, refer to the vignette."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">subsampling</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/ssp-logit.html">`ssp.glm`: Subsampling for Generalized Linear Models</a></li>
    <li><a class="dropdown-item" href="../articles/ssp-quantreg.html">`ssp.quantreg`: Subsampling for Quantile Regression</a></li>
    <li><a class="dropdown-item" href="../articles/ssp-relogit.html">`ssp.relogit`: Subsampling for Logistic Regression Model with Rare Events</a></li>
    <li><a class="dropdown-item" href="../articles/ssp-softmax.html">`ssp.softmax`: Subsampling for Softmax (Multinomial) Regression Model</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dqksnow/Subsampling/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Optimal Subsampling Methods for Generalized Linear Models</h1>
      <small class="dont-index">Source: <a href="https://github.com/dqksnow/Subsampling/blob/HEAD/R/general_glm_main_function.R" class="external-link"><code>R/general_glm_main_function.R</code></a></small>
      <div class="d-none name"><code>ssp.glm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Draw subsample from full dataset and fit a generalized linear model (GLM) on the subsample. For a quick start, refer to the <a href="https://dqksnow.github.io/subsampling/articles/ssp-logit.html">vignette</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ssp.glm</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">n.plt</span>,</span>
<span>  <span class="va">n.ssp</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>  criterion <span class="op">=</span> <span class="st">"optL"</span>,</span>
<span>  sampling.method <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>  likelihood <span class="op">=</span> <span class="st">"weighted"</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span>,</span>
<span>  contrasts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>A model formula object of class "formula" that describes the model to be fitted.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame containing the variables in the model. Denote \(N\) as the number of observations in <code>data</code>.</p></dd>


<dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>An optional vector specifying a subset of observations from <code>data</code> to use for the analysis. This subset will be viewed as the full data.</p></dd>


<dt id="arg-n-plt">n.plt<a class="anchor" aria-label="anchor" href="#arg-n-plt"></a></dt>
<dd><p>The pilot subsample size (first-step subsample size).
This subsample is used to compute the pilot estimator and estimate the optimal subsampling probabilities.</p></dd>


<dt id="arg-n-ssp">n.ssp<a class="anchor" aria-label="anchor" href="#arg-n-ssp"></a></dt>
<dd><p>The expected size of the optimal subsample (second-step subsample). For <code>sampling.method = 'withReplacement'</code>, The exact subsample size is <code>n.ssp</code>. For <code>sampling.method = 'poisson'</code>, <code>n.ssp</code> is the expected subsample size.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p><code>family</code> can be a character string naming a family function, a family function or the result of a call to a family function.</p></dd>


<dt id="arg-criterion">criterion<a class="anchor" aria-label="anchor" href="#arg-criterion"></a></dt>
<dd><p>The choices include <code>optA</code>, <code>optL</code>(default), <code>LCC</code> and <code>uniform.</code></p><ul><li><p><code>optA</code> Minimizes the trace of the asymptotic covariance matrix of the subsample estimator.</p></li>
<li><p><code>optL</code> Minimizes the trace of a transformation of the asymptotic covariance matrix. The computational complexity of
optA is \(O(N d^2)\) while that of optL is \(O(N d)\).</p></li>
<li><p><code>LCC</code> Local Case-Control sampling probability, used as a baseline subsampling strategy.</p></li>
<li><p><code>uniform</code> Assigns equal subsampling probability
\(\frac{1}{N}\) to each observation, serving as a baseline subsampling strategy.</p></li>
</ul></dd>


<dt id="arg-sampling-method">sampling.method<a class="anchor" aria-label="anchor" href="#arg-sampling-method"></a></dt>
<dd><p>The sampling method to use. Options include <code>withReplacement</code>
and <code>poisson</code> (default). <code>withReplacement</code> draws exactly <code>n.ssp</code>
subsamples from size \(N\) full dataset with replacement, using the specified
subsampling probabilities. <code>poisson</code> draws observations independently by
comparing each subsampling probability with a realization of uniform random
variable  \(U(0,1)\).</p>
<p>Differences between methods:</p><ul><li><p>Sample size: <code>withReplacement</code> draws exactly  <code>n.ssp</code> subsamples while <code>poisson</code> draws
subsamples with expected size <code>n.ssp</code>, meaning the actual size may vary.</p></li>
<li><p>Memory usage: <code>withReplacement</code> requires the entire dataset to be loaded at once, while <code>poisson</code>
allows for processing observations sequentially (will be implemented in future version).</p></li>
<li><p>Estimator performance: Theoretical results show that the <code>poisson</code> tends to get a
subsample estimator with lower asymptotic variance compared to the
<code>withReplacement</code></p></li>
</ul></dd>


<dt id="arg-likelihood">likelihood<a class="anchor" aria-label="anchor" href="#arg-likelihood"></a></dt>
<dd><p>The likelihood function to use. Options include <code>weighted</code> (default) and
<code>logOddsCorrection</code>. A bias-correction likelihood function is required for subsample since unequal subsampling probabilities introduce bias.</p><ul><li><p><code>weighted</code> Applies a weighted likelihood function where each observation is weighted by the inverse of its subsampling probability.</p></li>
<li><p><code>logOddsCorrection</code> This lieklihood is available only for logistic regression model (i.e., when family is binomial or quasibinomial). It uses a conditional likelihood, where each element of the likelihood represents the probability of \(Y=1\), given that this subsample was drawn.</p></li>
</ul></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>The argument <code>control</code> contains two tuning parameters <code>alpha</code> and <code>b</code>.</p><ul><li><p><code>alpha</code> \(\in [0,1]\) is the mixture weight of the user-assigned subsampling
probability and uniform subsampling probability. The actual subsample
probability is \(\pi = (1-\alpha)\pi^{opt} + \alpha \pi^{uni}\). This protects the estimator from extreme small
subsampling probability. The default value is 0.</p></li>
<li><p><code>b</code> is a positive number which is used to constaint the poisson subsampling probability. <code>b</code> close to 0 results in subsampling probabilities closer to uniform probability \(\frac{1}{N}\). <code>b=2</code> is the default value. See relevant references for further details.</p></li>
</ul></dd>


<dt id="arg-contrasts">contrasts<a class="anchor" aria-label="anchor" href="#arg-contrasts"></a></dt>
<dd><p>An optional list. It specifies how categorical variables are represented in the design matrix. For example, <code>contrasts = list(v1 = 'contr.treatment', v2 = 'contr.sum')</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>A list of parameters which will be passed to <code>svyglm()</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>ssp.glm</code> returns an object of class "ssp.glm" containing the following components (some are optional):</p>
<dl><dt>model.call</dt>
<dd><p>The original function call.</p></dd>

<dt>coef.plt</dt>
<dd><p>The pilot estimator. See Details for more information.</p></dd>

<dt>coef.ssp</dt>
<dd><p>The estimator obtained from the optimal subsample.</p></dd>

<dt>coef</dt>
<dd><p>The weighted linear combination of <code>coef.plt</code> and <code>coef.ssp</code>. The combination weights depend on the relative size of <code>n.plt</code> and <code>n.ssp</code> and the estimated covariance matrices of <code>coef.plt</code> and <code>coef.ssp.</code> We blend the pilot subsample information into optimal subsample estimator since the pilot subsample has already been drawn. The coefficients and standard errors reported by summary are <code>coef</code> and the square root of <code>diag(cov)</code>.</p></dd>

<dt>cov.ssp</dt>
<dd><p>The covariance matrix of <code>coef.ssp</code>.</p></dd>

<dt>cov</dt>
<dd><p>The covariance matrix of <code>coef</code>.</p></dd>

<dt>index.plt</dt>
<dd><p>Row indices of pilot subsample in the full dataset.</p></dd>

<dt>index.ssp</dt>
<dd><p>Row indices of of optimal subsample in the full dataset.</p></dd>

<dt>N</dt>
<dd><p>The number of observations in the full dataset.</p></dd>

<dt>subsample.size.expect</dt>
<dd><p>The expected subsample size, equals to <code>n.ssp</code> for <code>ssp.glm.</code> Note that for other functions, such as <a href="ssp.relogit.html">ssp.relogit</a>, this value may differ.</p></dd>

<dt>terms</dt>
<dd><p>The terms object for the fitted model.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>A pilot estimator for the unknown parameter  \(\beta\) is required because both optA and
optL subsampling probabilities depend on \(\beta\). There is no "free lunch" when determining optimal subsampling probabilities. Fortunately the
pilot estimator only needs to satisfy mild conditions. For logistic regression, this
is achieved by drawing a size <code>n.plt</code> subsample with replacement from full
dataset. The case-control subsample probability is applied, that is, \(\pi_i =
  \frac{1}{2N_1}\) for  \(Y_i=1\) and  \(\pi_i = \frac{1}{2N_0}\) for  \(Y_i=0\),
\(i=1,...,N\), where\(N_0\) and \(N_1\) are the counts of observations with \(Y = 0\) and \(Y = 1\), respectively. For other
families, uniform subsampling probabilities are applied. Typically, <code>n.plt</code> is
relatively small compared to <code>n.ssp</code>.</p>
<p>When <code>criterion = 'uniform'</code>, there is no need to compute the pilot estimator. In this case, a size <code>n.plt + n.ssp</code> subsample will be drawn with uniform sampling probability and <code>coef</code> is the corresponding  estimator.</p>
<p>As suggested by <code><a href="https://rdrr.io/pkg/survey/man/svyglm.html" class="external-link">survey::svyglm()</a></code>, for binomial and poisson families, use <code>family=quasibinomial()</code> and <code>family=quasipoisson()</code> to avoid a warning "In eval(family$initialize) : non-integer #successes in a binomial glm!". The quasi versions of the family objects give the same point estimates and suppress the warning. Since subsampling methods only rely on point estimates from svyglm() for further computation, using the quasi families does not introduce any issues.</p>
<p>For Gamma family, <code>ssp.glm</code> returns only the estimation of coefficients, as the dispersion parameter is not estimated.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Wang, H. (2019). More efficient estimation for logistic regression with optimal subsamples. <em>Journal of machine learning research</em>, <strong>20</strong>(132), 1-59.</p>
<p>Ai, M., Yu, J., Zhang, H., &amp; Wang, H. (2021). Optimal subsampling algorithms for big data regressions. <em>Statistica Sinica</em>, <strong>31</strong>(2), 749-772.</p>
<p>Wang, H., &amp; Kim, J. K. (2022). Maximum sampled conditional likelihood for informative subsampling. <em>Journal of machine learning research</em>, <strong>23</strong>(332), 1-50.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># logistic regression</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">1e4</span></span></span>
<span class="r-in"><span><span class="va">beta0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">beta0</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">corr</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span><span class="va">sigmax</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">corr</span>, <span class="va">d</span>, <span class="va">d</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">corr</span>, <span class="va">d</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">N</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">d</span><span class="op">)</span>, <span class="va">sigmax</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">N</span>, <span class="fl">1</span>, <span class="fl">1</span> <span class="op">-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">beta0</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta0</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">.</span></span></span>
<span class="r-in"><span><span class="va">n.plt</span> <span class="op">&lt;-</span> <span class="fl">500</span></span></span>
<span class="r-in"><span><span class="va">n.ssp</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">subsampling.results</span> <span class="op">&lt;-</span> <span class="fu">ssp.glm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, </span></span>
<span class="r-in"><span>data <span class="op">=</span> <span class="va">data</span>, </span></span>
<span class="r-in"><span>n.plt <span class="op">=</span> <span class="va">n.plt</span>,</span></span>
<span class="r-in"><span>n.ssp <span class="op">=</span> <span class="va">n.ssp</span>,</span></span>
<span class="r-in"><span>family <span class="op">=</span> <span class="st">'quasibinomial'</span>,</span></span>
<span class="r-in"><span>criterion <span class="op">=</span> <span class="st">"optL"</span>,</span></span>
<span class="r-in"><span>sampling.method <span class="op">=</span> <span class="st">'poisson'</span>,</span></span>
<span class="r-in"><span>likelihood <span class="op">=</span> <span class="st">"logOddsCorrection"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">subsampling.results</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ssp.glm(formula = formula, data = data, n.plt = n.plt, n.ssp = n.ssp, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     family = "quasibinomial", criterion = "optL", sampling.method = "poisson", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     likelihood = "logOddsCorrection")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Subsample Size:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       Total Sample Size  10000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Expected Subsample Size   1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Actual Subsample Size   1034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Unique Subsample Size   1034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  Expected Subample Rate    10%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    Actual Subample Rate 10.34%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    Unique Subample Rate 10.34%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Estimate Std. Error z value Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept  -0.5430     0.0603 -9.0098  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V2         -0.5562     0.0743 -7.4864  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V3         -0.4597     0.0726 -6.3341  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V4         -0.4561     0.0761 -5.9945  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V5         -0.5714     0.0755 -7.5644  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V6         -0.4958     0.0721 -6.8725  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V7         -0.4962     0.0736 -6.7385  &lt;0.0001</span>
<span class="r-in"><span><span class="va">subsampling.results</span> <span class="op">&lt;-</span> <span class="fu">ssp.glm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, </span></span>
<span class="r-in"><span>data <span class="op">=</span> <span class="va">data</span>, </span></span>
<span class="r-in"><span>n.plt <span class="op">=</span> <span class="va">n.plt</span>,</span></span>
<span class="r-in"><span>n.ssp <span class="op">=</span> <span class="va">n.ssp</span>,</span></span>
<span class="r-in"><span>family <span class="op">=</span> <span class="st">'quasibinomial'</span>, </span></span>
<span class="r-in"><span>criterion <span class="op">=</span> <span class="st">"optL"</span>,</span></span>
<span class="r-in"><span>sampling.method <span class="op">=</span> <span class="st">'withReplacement'</span>, </span></span>
<span class="r-in"><span>likelihood <span class="op">=</span> <span class="st">"weighted"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">subsampling.results</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ssp.glm(formula = formula, data = data, n.plt = n.plt, n.ssp = n.ssp, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     family = "quasibinomial", criterion = "optL", sampling.method = "withReplacement", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     likelihood = "weighted")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Subsample Size:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       Total Sample Size 10000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Expected Subsample Size  1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Actual Subsample Size  1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Unique Subsample Size   901</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  Expected Subample Rate   10%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    Actual Subample Rate   10%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    Unique Subample Rate 9.01%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Estimate Std. Error z value Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept  -0.5201     0.0649 -8.0143  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V2         -0.6526     0.0853 -7.6500  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V3         -0.4247     0.0864 -4.9176  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V4         -0.2804     0.0841 -3.3329   0.0009</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V5         -0.5186     0.0792 -6.5508  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V6         -0.6281     0.0837 -7.5026  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V7         -0.5878     0.0836 -7.0348  &lt;0.0001</span>
<span class="r-in"><span><span class="va">Uni.subsampling.results</span> <span class="op">&lt;-</span> <span class="fu">ssp.glm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, </span></span>
<span class="r-in"><span>data <span class="op">=</span> <span class="va">data</span>, </span></span>
<span class="r-in"><span>n.plt <span class="op">=</span> <span class="va">n.plt</span>,</span></span>
<span class="r-in"><span>n.ssp <span class="op">=</span> <span class="va">n.ssp</span>,</span></span>
<span class="r-in"><span>family <span class="op">=</span> <span class="st">'quasibinomial'</span>, </span></span>
<span class="r-in"><span>criterion <span class="op">=</span> <span class="st">'uniform'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Uni.subsampling.results</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ssp.glm(formula = formula, data = data, n.plt = n.plt, n.ssp = n.ssp, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     family = "quasibinomial", criterion = "uniform")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Subsample Size:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       Total Sample Size  10000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Expected Subsample Size   1500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Actual Subsample Size   1462</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Unique Subsample Size   1462</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  Expected Subample Rate    15%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    Actual Subample Rate 14.62%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    Unique Subample Rate 14.62%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Estimate Std. Error z value Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept  -0.5165     0.0720 -7.1700  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V2         -0.7625     0.1000 -7.6253  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V3         -0.3873     0.0919 -4.2152  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V4         -0.3826     0.0976 -3.9188  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V5         -0.5533     0.0914 -6.0567  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V6         -0.3779     0.0991 -3.8143   0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V7         -0.5427     0.0923 -5.8806  &lt;0.0001</span>
<span class="r-in"><span><span class="co">####################</span></span></span>
<span class="r-in"><span><span class="co"># poisson regression</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span>  <span class="fl">1e4</span></span></span>
<span class="r-in"><span><span class="va">beta0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">beta0</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span> <span class="op">*</span> <span class="va">d</span><span class="op">)</span>, <span class="va">N</span>, <span class="va">d</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">epsilon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">beta0</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta0</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">N</span>, <span class="va">lambda</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">.</span></span></span>
<span class="r-in"><span><span class="va">n.plt</span> <span class="op">&lt;-</span> <span class="fl">200</span></span></span>
<span class="r-in"><span><span class="va">n.ssp</span> <span class="op">&lt;-</span> <span class="fl">600</span></span></span>
<span class="r-in"><span><span class="va">subsampling.results</span> <span class="op">&lt;-</span> <span class="fu">ssp.glm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, </span></span>
<span class="r-in"><span>data <span class="op">=</span> <span class="va">data</span>, </span></span>
<span class="r-in"><span>n.plt <span class="op">=</span> <span class="va">n.plt</span>,</span></span>
<span class="r-in"><span>n.ssp <span class="op">=</span> <span class="va">n.ssp</span>,</span></span>
<span class="r-in"><span>family <span class="op">=</span> <span class="st">'poisson'</span>,</span></span>
<span class="r-in"><span>criterion <span class="op">=</span> <span class="st">"optL"</span>, </span></span>
<span class="r-in"><span>sampling.method <span class="op">=</span> <span class="st">'poisson'</span>,</span></span>
<span class="r-in"><span>likelihood <span class="op">=</span> <span class="st">"weighted"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">subsampling.results</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ssp.glm(formula = formula, data = data, n.plt = n.plt, n.ssp = n.ssp, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     family = "poisson", criterion = "optL", sampling.method = "poisson", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     likelihood = "weighted")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Subsample Size:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       Total Sample Size 10000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Expected Subsample Size   600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Actual Subsample Size   681</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Unique Subsample Size   681</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  Expected Subample Rate    6%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    Actual Subample Rate 6.81%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    Unique Subample Rate 6.81%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Estimate Std. Error z value Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept   0.5662     0.0568  9.9711  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V2          0.4893     0.0357 13.7219  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V3          0.5126     0.0370 13.8583  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V4          0.4253     0.0351 12.1181  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V5          0.4972     0.0397 12.5128  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V6          0.4930     0.0383 12.8792  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V7          0.4871     0.0377 12.9209  &lt;0.0001</span>
<span class="r-in"><span><span class="va">subsampling.results</span> <span class="op">&lt;-</span> <span class="fu">ssp.glm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, </span></span>
<span class="r-in"><span>data <span class="op">=</span> <span class="va">data</span>, </span></span>
<span class="r-in"><span>n.plt <span class="op">=</span> <span class="va">n.plt</span>,</span></span>
<span class="r-in"><span>n.ssp <span class="op">=</span> <span class="va">n.ssp</span>,</span></span>
<span class="r-in"><span>family <span class="op">=</span> <span class="st">'poisson'</span>, </span></span>
<span class="r-in"><span>criterion <span class="op">=</span> <span class="st">"optL"</span>, </span></span>
<span class="r-in"><span>sampling.method <span class="op">=</span> <span class="st">'withReplacement'</span>,</span></span>
<span class="r-in"><span>likelihood <span class="op">=</span> <span class="st">"weighted"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">subsampling.results</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ssp.glm(formula = formula, data = data, n.plt = n.plt, n.ssp = n.ssp, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     family = "poisson", criterion = "optL", sampling.method = "withReplacement", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     likelihood = "weighted")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Subsample Size:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       Total Sample Size 10000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Expected Subsample Size   600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Actual Subsample Size   600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Unique Subsample Size   568</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  Expected Subample Rate    6%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    Actual Subample Rate    6%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    Unique Subample Rate 5.68%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Estimate Std. Error z value Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept   0.5543     0.0590  9.3997  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V2          0.4505     0.0402 11.2074  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V3          0.4643     0.0423 10.9781  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V4          0.5392     0.0420 12.8471  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V5          0.4497     0.0425 10.5933  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V6          0.4529     0.0415 10.9180  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V7          0.5495     0.0395 13.9048  &lt;0.0001</span>
<span class="r-in"><span><span class="va">Uni.subsampling.results</span> <span class="op">&lt;-</span> <span class="fu">ssp.glm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, </span></span>
<span class="r-in"><span>data <span class="op">=</span> <span class="va">data</span>, </span></span>
<span class="r-in"><span>n.plt <span class="op">=</span> <span class="va">n.plt</span>,</span></span>
<span class="r-in"><span>n.ssp <span class="op">=</span> <span class="va">n.ssp</span>,</span></span>
<span class="r-in"><span>family <span class="op">=</span> <span class="st">'poisson'</span>, </span></span>
<span class="r-in"><span>criterion <span class="op">=</span> <span class="st">'uniform'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Uni.subsampling.results</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ssp.glm(formula = formula, data = data, n.plt = n.plt, n.ssp = n.ssp, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     family = "poisson", criterion = "uniform")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Subsample Size:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       Total Sample Size 10000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Expected Subsample Size   800</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Actual Subsample Size   820</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Unique Subsample Size   820</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  Expected Subample Rate    8%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    Actual Subample Rate  8.2%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    Unique Subample Rate  8.2%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Estimate Std. Error z value Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept   0.4226     0.0591  7.1479  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V2          0.5789     0.0431 13.4381  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V3          0.4852     0.0425 11.4087  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V4          0.5401     0.0427 12.6439  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V5          0.4419     0.0432 10.2351  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V6          0.5156     0.0436 11.8327  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V7          0.5311     0.0418 12.6998  &lt;0.0001</span>
<span class="r-in"><span><span class="co">##################</span></span></span>
<span class="r-in"><span><span class="co"># gamma regression</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">1e4</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">beta0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">p</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">beta0</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">shape</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span> <span class="op">*</span> <span class="va">d</span><span class="op">)</span>, <span class="va">N</span>, <span class="va">d</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">link_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span>, <span class="va">beta0</span><span class="op">)</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">beta0</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta0</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">scale</span> <span class="op">&lt;-</span> <span class="fu">link_function</span><span class="op">(</span><span class="va">X</span>, <span class="va">beta0</span><span class="op">)</span> <span class="op">/</span> <span class="va">shape</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="va">N</span>, shape <span class="op">=</span> <span class="va">shape</span>, scale <span class="op">=</span> <span class="va">scale</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">.</span></span></span>
<span class="r-in"><span><span class="va">n.plt</span> <span class="op">&lt;-</span> <span class="fl">200</span></span></span>
<span class="r-in"><span><span class="va">n.ssp</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">subsampling.results</span> <span class="op">&lt;-</span> <span class="fu">ssp.glm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, </span></span>
<span class="r-in"><span>data <span class="op">=</span> <span class="va">data</span>, </span></span>
<span class="r-in"><span>n.plt <span class="op">=</span> <span class="va">n.plt</span>,</span></span>
<span class="r-in"><span>n.ssp <span class="op">=</span> <span class="va">n.ssp</span>,</span></span>
<span class="r-in"><span>family <span class="op">=</span> <span class="st">'Gamma'</span>,</span></span>
<span class="r-in"><span>criterion <span class="op">=</span> <span class="st">"optL"</span>, </span></span>
<span class="r-in"><span>sampling.method <span class="op">=</span> <span class="st">'poisson'</span>,</span></span>
<span class="r-in"><span>likelihood <span class="op">=</span> <span class="st">"weighted"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">subsampling.results</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ssp.glm(formula = formula, data = data, n.plt = n.plt, n.ssp = n.ssp, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     family = "Gamma", criterion = "optL", sampling.method = "poisson", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     likelihood = "weighted")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Subsample Size:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       Total Sample Size 10000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Expected Subsample Size  1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Actual Subsample Size   989</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Unique Subsample Size   989</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  Expected Subample Rate   10%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    Actual Subample Rate 9.89%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    Unique Subample Rate 9.89%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Estimate Std. Error z value Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept   0.5099     0.0510  9.9893  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V2          0.4732     0.0603  7.8469  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V3          0.4040     0.0621  6.5035  &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V4          0.4945     0.0681  7.2599  &lt;0.0001</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Qingkai Dong, Yaqiong Yao, Haiying Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

