<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Optimal Subsampling Method for Softmax (multinomial logistic) Regression Model — ssp.softmax • subsampling</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Optimal Subsampling Method for Softmax (multinomial logistic) Regression Model — ssp.softmax"><meta property="og:description" content="Draw subsample from full dataset and fit softmax(multinomial logistic) regression model on the subsample. Refer to vignette for a quick start."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">subsampling</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/ssp-logit.html">Introduction to `ssp.glm`: Subsampling for Generalized Linear Models</a>
    </li>
    <li>
      <a href="../articles/ssp-quantreg.html">Introduction to `ssp.quantreg`: Subsampling for Quantile Regression</a>
    </li>
    <li>
      <a href="../articles/ssp-relogit.html">Introduction to `ssp.relogit`: Subsampling for Logistic Regression Model with Rare Events</a>
    </li>
    <li>
      <a href="../articles/ssp-softmax.html">Introduction to `ssp.softmax`: Subsampling for Softmax (Multinomial) Regression Model</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dqksnow/Subsampling/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Optimal Subsampling Method for Softmax (multinomial logistic) Regression Model</h1>
    <small class="dont-index">Source: <a href="https://github.com/dqksnow/Subsampling/blob/HEAD/R/softmax_main_function.R" class="external-link"><code>R/softmax_main_function.R</code></a></small>
    <div class="hidden name"><code>ssp.softmax.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Draw subsample from full dataset and fit softmax(multinomial logistic) regression model on the subsample. Refer to <a href="https://dqksnow.github.io/subsampling/articles/ssp-softmax.html" class="external-link">vignette</a> for a quick start.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ssp.softmax</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">subset</span>,</span>
<span>  <span class="va">n.plt</span>,</span>
<span>  <span class="va">n.ssp</span>,</span>
<span>  criterion <span class="op">=</span> <span class="st">"MSPE"</span>,</span>
<span>  sampling.method <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>  likelihood <span class="op">=</span> <span class="st">"MSCLE"</span>,</span>
<span>  constraint <span class="op">=</span> <span class="st">"summation"</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span>,</span>
<span>  contrasts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>formula</dt>
<dd><p>A model formula object of class "formula" that describes the model to be fitted.</p></dd>


<dt>data</dt>
<dd><p>A data frame containing the variables in the model. Denote \(N\) as the number of observations in <code>data</code>.</p></dd>


<dt>subset</dt>
<dd><p>An optional vector specifying a subset of observations from <code>data</code> to use for the analysis. This subset will be viewed as the full data.</p></dd>


<dt>n.plt</dt>
<dd><p>The pilot subsample size (first-step subsample size).
This subsample is used to compute the pilot estimator and estimate the optimal subsampling probabilities.</p></dd>


<dt>n.ssp</dt>
<dd><p>The expected size of the optimal subsample (second-step subsample). For <code>sampling.method = 'withReplacement'</code>, The exact subsample size is <code>n.ssp</code>. For <code>sampling.method = 'poisson'</code>, <code>n.ssp</code> is the expected subsample size.</p></dd>


<dt>criterion</dt>
<dd><p>The criterion of optimal subsampling probabilities.
Choices include <code>optA</code>, <code>optL</code>, <code>MSPE</code>(default), <code>LUC</code> and <code>uniform</code>.</p><ul><li><p><code>MSPE</code> Minimizes the mean squared prediction error between subsample estimator and full data estimator.</p></li>
<li><p><code>optA</code> Minimizes the trace of the asymptotic covariance matrix of the subsample estimator.</p></li>
<li><p><code>optL</code> Minimizes the trace of a transformation of the asymptotic covariance matrix, which reduces computational costs than <code>optA</code>.</p></li>
<li><p><code>LUC</code> Local uncertainty sampling method, serving as a baseline subsampling strategy. See Wang and Kim (2022).</p></li>
<li><p><code>uniform</code> Assigns equal subsampling probability
\(\frac{1}{N}\) to each observation, serving as a baseline subsampling strategy.</p></li>
</ul></dd>


<dt>sampling.method</dt>
<dd><p>The sampling method to use.
Choices include <code>withReplacement</code> and <code>poisson</code>(default). <code>withReplacement</code> draws exactly <code>n.ssp</code>
subsamples from size \(N\) full dataset with replacement, using the specified
subsampling probabilities. <code>poisson</code> draws observations independently by
comparing each subsampling probability with a realization of uniform random
variable  \(U(0,1)\).
Differences between methods:</p><ul><li><p>Sample size: <code>withReplacement</code> draws exactly  <code>n.ssp</code> subsamples while <code>poisson</code> draws
subsamples with expected size <code>n.ssp</code>, meaning the actual size may vary.</p></li>
<li><p>Memory usage: <code>withReplacement</code> requires the entire dataset to be loaded at once, while <code>poisson</code>
allows for processing observations sequentially (will be implemented in future version).</p></li>
<li><p>Estimator performance: Theoretical results show that the <code>poisson</code> tends to get a
subsample estimator with lower asymptotic variance compared to the
<code>withReplacement</code></p></li>
</ul></dd>


<dt>likelihood</dt>
<dd><p>A bias-correction likelihood function is required for subsample since unequal subsampling probabilities introduce bias. Choices include
<code>weighted</code> and <code>MSCLE</code>(default).</p><ul><li><p><code>weighted</code> Applies a weighted likelihood function where each observation is weighted by the inverse of its subsampling probability.</p></li>
<li><p><code>MSCLE</code> It uses a conditional likelihood, where each element of the likelihood represents the density of \(Y_i\) given that this observation was drawn.</p></li>
</ul></dd>


<dt>constraint</dt>
<dd><p>The constraint for identifiability of softmax model. Choices include
<code>baseline</code> and <code>summation</code>(default). The baseline constraint assumes the coefficient for the baseline category are \(0\). Without loss of generality, we set the category \(Y=0\) as the baseline category so that \(\boldsymbol{\beta}_0=0\). The summation constraint \(\sum_{k=0}^{K} \boldsymbol{\beta}_k\) is also used in the subsampling method for the purpose of calculating subsampling probability. These two constraints lead to different interpretation of coefficients but are equal for computing \(P(Y_{i,k} = 1 \mid \mathbf{x}_i)\). The estimation of coefficients returned by <code>ssp.softmax()</code> is under baseline constraint.</p></dd>


<dt>control</dt>
<dd><p>A list of parameters for controlling the sampling process. There are two tuning parameters <code>alpha</code> and <code>b</code>. Default is <code>list(alpha=0, b=2)</code>.</p><ul><li><p><code>alpha</code> \(\in [0,1]\) is the mixture weight of the user-assigned subsampling
probability and uniform subsampling probability. The actual subsample
probability is \(\pi = (1-\alpha)\pi^{opt} + \alpha \pi^{uni}\). This protects the estimator from extreme small
subsampling probability. The default value is 0.</p></li>
<li><p><code>b</code> is a positive number which is used to constaint the poisson subsampling probability. <code>b</code> close to 0 results in subsampling probabilities closer to uniform probability \(\frac{1}{N}\). <code>b=2</code> is the default value. See relevant references for further details.</p></li>
</ul></dd>


<dt>contrasts</dt>
<dd><p>An optional list. It specifies how categorical variables are represented in the design matrix. For example, <code>contrasts = list(v1 = 'contr.treatment', v2 = 'contr.sum')</code>.</p></dd>


<dt>...</dt>
<dd><p>A list of parameters which will be passed to <code><a href="https://rdrr.io/pkg/nnet/man/multinom.html" class="external-link">nnet::multinom()</a></code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>ssp.softmax returns an object of class "ssp.softmax" containing the following components (some are optional):</p><dl><dt>model.call</dt>
<dd><p>The original function call.</p></dd>

<dt>coef.plt</dt>
<dd><p>The pilot estimator. See Details for more information.</p></dd>

<dt>coef.ssp</dt>
<dd><p>The estimator obtained from the optimal subsample.</p></dd>

<dt>coef</dt>
<dd><p>The weighted linear combination of <code>coef.plt</code> and <code>coef.ssp</code>. The combination weights depend on the relative size of <code>n.plt</code> and <code>n.ssp</code> and the estimated covariance matrices of <code>coef.plt</code> and <code>coef.ssp.</code> We blend the pilot subsample information into optimal subsample estimator since the pilot subsample has already been drawn. The coefficients and standard errors reported by summary are <code>coef</code> and the square root of <code>diag(cov)</code>.</p></dd>

<dt>cov.ssp</dt>
<dd><p>The covariance matrix of <code>coef.ssp</code>.</p></dd>

<dt>cov</dt>
<dd><p>The covariance matrix of <code>beta.cmb</code>.</p></dd>

<dt>index.plt</dt>
<dd><p>Row indices of pilot subsample in the full dataset.</p></dd>

<dt>index.ssp</dt>
<dd><p>Row indices of of optimal subsample in the full dataset.</p></dd>

<dt>N</dt>
<dd><p>The number of observations in the full dataset.</p></dd>

<dt>subsample.size.expect</dt>
<dd><p>The expected subsample size.</p></dd>

<dt>terms</dt>
<dd><p>The terms object for the fitted model.</p></dd>


</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>A pilot estimator for the unknown parameter  \(\beta\) is required because MSPE, optA and
optL subsampling probabilities depend on \(\beta\). There is no "free lunch" when determining optimal subsampling probabilities. For softmax regression, this
is achieved by drawing a size <code>n.plt</code> subsample with replacement from full
dataset with uniform sampling probability.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Yao, Y., &amp; Wang, H. (2019). Optimal subsampling for softmax regression. <em>Statistical Papers</em>, <strong>60</strong>, 585-599.</p>
<p>Han, L., Tan, K. M., Yang, T., &amp; Zhang, T. (2020). Local uncertainty sampling for large-scale multiclass logistic regression. <em>Annals of Statistics</em>, <strong>48</strong>(3), 1770-1788.</p>
<p>Wang, H., &amp; Kim, J. K. (2022). Maximum sampled conditional likelihood for informative subsampling. <em>Journal of machine learning research</em>, <strong>23</strong>(332), 1-50.</p>
<p>Yao, Y., Zou, J., &amp; Wang, H. (2023). Optimal poisson subsampling for softmax regression. <em>Journal of Systems Science and Complexity</em>, <strong>36</strong>(4), 1609-1625.</p>
<p>Yao, Y., Zou, J., &amp; Wang, H. (2023). Model constraints independent optimal subsampling probabilities for softmax regression. <em>Journal of Statistical Planning and Inference</em>, <strong>225</strong>, 188-201.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># softmax regression</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="co"># dim of covariates</span></span></span>
<span class="r-in"><span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="co"># K + 1 classes</span></span></span>
<span class="r-in"><span><span class="va">G</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">K</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>, <span class="va">K</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">K</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">K</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/kronecker.html" class="external-link">%x%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">1e4</span></span></span>
<span class="r-in"><span><span class="va">beta.true.baseline</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">d</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>, <span class="va">d</span>, <span class="va">K</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">beta.true.summation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">d</span><span class="op">)</span>, <span class="fl">0.5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="va">d</span>, <span class="va">K</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">d</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.5</span>, nrow <span class="op">=</span> <span class="va">d</span>, ncol <span class="op">=</span> <span class="va">d</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">d</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">N</span>, <span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta.true.summation</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">prob</span> <span class="op">&lt;-</span> <span class="va">prob</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">prob</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">prob</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">row</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">K</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">row</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n.plt</span> <span class="op">&lt;-</span> <span class="fl">500</span></span></span>
<span class="r-in"><span><span class="va">n.ssp</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Y         V1          V2         V3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2 -0.3756189 -0.17727086 -0.9816025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2  0.2912939  0.60753208 -0.4489936</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2 -1.0530547  0.02079337 -1.0146024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0  0.1854791  2.45385260  1.2682922</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0  0.8687332  0.21941612 -0.2810234</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 1 -0.8336174 -0.32556141 -0.8505501</span>
<span class="r-in"><span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span><span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">WithRep.MSPE</span> <span class="op">&lt;-</span> <span class="fu">ssp.softmax</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>,</span></span>
<span class="r-in"><span> data <span class="op">=</span> <span class="va">data</span>, </span></span>
<span class="r-in"><span> n.plt <span class="op">=</span> <span class="va">n.plt</span>,</span></span>
<span class="r-in"><span> n.ssp <span class="op">=</span> <span class="va">n.ssp</span>,</span></span>
<span class="r-in"><span> criterion <span class="op">=</span> <span class="st">'MSPE'</span>, </span></span>
<span class="r-in"><span> sampling.method <span class="op">=</span> <span class="st">'withReplacement'</span>,</span></span>
<span class="r-in"><span> likelihood <span class="op">=</span> <span class="st">'weighted'</span>,</span></span>
<span class="r-in"><span> constraint <span class="op">=</span> <span class="st">'baseline'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Message from nnet::multinom: "</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  12 (6 variable)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 549.306144 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 367.125951</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 365.836516 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> converged</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Message from nnet::multinom: "</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  12 (6 variable)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 11677047.319684 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 7149711.444798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 6901692.808182</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 6901684.550943 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> converged</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">WithRep.MSPE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ssp.softmax(formula = formula, data = data, n.plt = n.plt, n.ssp = n.ssp, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     criterion = "MSPE", sampling.method = "withReplacement", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     likelihood = "weighted", constraint = "baseline")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Subsample Size:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       Total Sample Size 10000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Expected Subsample Size  1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Actual Subsample Size  1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Unique Subsample Size   927</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  Expected Subample Rate   10%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    Actual Subample Rate   10%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    Unique Subample Rate 9.27%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         [,1]      [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V1 -1.455068 -1.406786</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V2 -1.647116 -1.492484</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V3 -1.248385 -1.435806</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Std. Errors:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]       [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V1 0.08803001 0.08917739</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V2 0.08516142 0.08456003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V3 0.08726432 0.08841460</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Qingkai Dong, Yaqiong Yao, Haiying Wang.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

