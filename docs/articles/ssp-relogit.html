<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>`ssp.relogit`: Subsampling for Logistic Regression Model with Rare Events • subsampling</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="`ssp.relogit`: Subsampling for Logistic Regression Model with Rare Events">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">subsampling</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/ssp-logit.html">`ssp.glm`: Subsampling for Generalized Linear Models</a></li>
    <li><a class="dropdown-item" href="../articles/ssp-quantreg.html">`ssp.quantreg`: Subsampling for Quantile Regression</a></li>
    <li><a class="dropdown-item" href="../articles/ssp-relogit.html">`ssp.relogit`: Subsampling for Logistic Regression Model with Rare Events</a></li>
    <li><a class="dropdown-item" href="../articles/ssp-softmax.html">`ssp.softmax`: Subsampling for Softmax (Multinomial) Regression Model</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dqksnow/Subsampling/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>`ssp.relogit`: Subsampling for Logistic Regression Model with Rare Events</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dqksnow/Subsampling/blob/HEAD/vignettes/ssp-relogit.Rmd" class="external-link"><code>vignettes/ssp-relogit.Rmd</code></a></small>
      <div class="d-none name"><code>ssp-relogit.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dqksnow/subsampling" class="external-link">subsampling</a></span><span class="op">)</span></span></code></pre></div>
<p>This vignette introduces the usage of <code>ssp.relogit</code>. The
statistical theory and algorithms in this implementation can be found in
relevant reference papers.</p>
<p>The logistic regression log-likelihood function is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><mo>max</mo><mi>β</mi></munder><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>y</mi><mi>i</mi></msub><msup><mi>β</mi><mi>⊤</mi></msup><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><msup><mi>β</mi><mi>⊤</mi></msup><msub><mi>x</mi><mi>i</mi></msub></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\max_{\beta} L(\beta) = \frac{1}{N} \sum_{i=1}^N \left[y_i \beta^{\top} x_i -
\log\left(1 + e^{\beta^\top x_i}\right) \right].
</annotation></semantics></math></p>
<div class="section level2">
<h2 id="terminology">Terminology<a class="anchor" aria-label="anchor" href="#terminology"></a>
</h2>
<ul>
<li><p>Full dataset: The whole dataset used as input.</p></li>
<li><p>Full data estimator: The estimator obtained by fitting the model
on the full dataset.</p></li>
<li><p>Subsample: A subset of observations drawn from the full
dataset.</p></li>
<li><p>Subsample estimator: The estimator obtained by fitting the model
on the subsample.</p></li>
<li><p>Subsampling probability
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>π</mi><annotation encoding="application/x-tex">\pi</annotation></semantics></math>):
The probability assigned to each observation for inclusion in the
subsample.</p></li>
<li><p>Rare events: Observations where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">Y=1</annotation></semantics></math>
(positive instances).</p></li>
<li><p>Non-rare events: Observations where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">Y=0</annotation></semantics></math>
(negative instances).</p></li>
</ul>
<p>The idea of subsampling methods is as follows: instead of fitting the
model on the size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
full dataset, a subsampling probability is assigned to each observation
and a smaller, informative subsample is drawn. The model is then fitted
on the subsample to obtain an estimator with reduced computational
cost.</p>
<p>In the face of logistic regression with rare events, <span class="citation">Wang, Zhang, and Wang (2021)</span> shows that the
available information ties to the number of positive instances instead
of the full data size. Based on this insight, one can keep all the rare
instances and perform subsampling on the non-rare instances to reduce
the computational cost.</p>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>We introduce the basic usage by using <code>ssp.relogit</code> with
simulated data.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
contains
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mn>6</mn></mrow><annotation encoding="application/x-tex">d=6</annotation></semantics></math>
covariates drawn from multinormal distribution and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
is the binary response variable. The full data size is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>2</mn><mo>×</mo><msup><mn>10</mn><mn>4</mn></msup></mrow><annotation encoding="application/x-tex">N = 2 \times 10^4</annotation></semantics></math>.
Denote
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mn>1</mn></msub><mo>=</mo><mi>s</mi><mi>u</mi><mi>m</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N_{1}=sum(Y)</annotation></semantics></math>
as the counts of rare observations and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mn>0</mn></msub><mo>=</mo><mi>N</mi><mo>−</mo><msub><mi>N</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">N_{0} = N - N_{1}</annotation></semantics></math>
as the counts of non-rare observations.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="fl">1e4</span></span>
<span><span class="va">beta0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">beta0</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">N</span>, <span class="va">d</span><span class="op">)</span></span>
<span><span class="va">corr</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">sigmax</span> <span class="op">&lt;-</span> <span class="va">corr</span> <span class="op">^</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">d</span>, <span class="fl">1</span><span class="op">:</span><span class="va">d</span>, <span class="st">"-"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">N</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">d</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="va">sigmax</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">N</span>, <span class="fl">1</span>, <span class="fl">1</span> <span class="op">-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">beta0</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta0</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'N: '</span>, <span class="va">N</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "N:  20000"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'sum(Y): '</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "sum(Y):  266"</span></span>
<span><span class="va">n.plt</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="va">n.ssp</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="key-arguments">Key Arguments<a class="anchor" aria-label="anchor" href="#key-arguments"></a>
</h2>
<p>The function usage is</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ssp.relogit.html">ssp.relogit</a></span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">n.plt</span>,</span>
<span>  <span class="va">n.ssp</span>,</span>
<span>  criterion <span class="op">=</span> <span class="st">"optL"</span>,</span>
<span>  likelihood <span class="op">=</span> <span class="st">"logOddsCorrection"</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span>,</span>
<span>  contrasts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The core functionality of <code>ssp.glm</code> revolves around three
key questions:</p>
<ul>
<li><p>How are subsampling probabilities computed? (Controlled by the
<code>criterion</code> argument)</p></li>
<li><p>How is the subsample drawn?</p></li>
<li><p>How is the likelihood adjusted to correct for bias? (Controlled
by the <code>likelihood</code> argument)</p></li>
</ul>
<p>Different from <code>ssp.glm</code> which can choose
<code>withReplacement</code> and <code>poisson</code> as the option of
<code>sampling.method</code>, <code>ssp.relogit</code> uses
<code>poisson</code> as default sampling method. <code>poisson</code>
stands for drawing subsamples one by one by comparing the subsampling
probability with a realization of uniform random variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">U(0,1)</annotation></semantics></math>.
The actual size of drawn subsample is random but the expected size is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>.</mi><mi>s</mi><mi>s</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">n.ssp</annotation></semantics></math>.</p>
<div class="section level3">
<h3 id="criterion">
<code>criterion</code><a class="anchor" aria-label="anchor" href="#criterion"></a>
</h3>
<p>The choices of <code>criterion</code> include <code>optA</code>,
<code>optL</code>(default), <code>LCC</code> and <code>uniform</code>.
The optimal subsampling criterion <code>optA</code> and
<code>optL</code> are derived by minimizing the asymptotic covariance of
subsample estimator, proposed by <span class="citation">Wang, Zhu, and
Ma (2018)</span>. <code>LCC</code> and <code>uniform</code> are baseline
methods.</p>
<p>Note that for rare observations
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">Y=1</annotation></semantics></math>
in the full data, the sampling probabilities are
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>.
For non-rare observations, the sampling probabilities depend on the
choice of <code>criterion</code>.</p>
</div>
<div class="section level3">
<h3 id="likelihood">
<code>likelihood</code><a class="anchor" aria-label="anchor" href="#likelihood"></a>
</h3>
<p>The available choices for <code>likelihood</code> include
<code>weighted</code> and <code>logOddsCorrection</code>(default). Both
of these likelihood functions can derive an unbiased estimator.
Theoretical results indicate that <code>logOddsCorrection</code> is more
efficient than <code>weighted</code> in the context of rare events
logistic regression. See @<span class="citation">Wang, Zhang, and Wang
(2021)</span>.</p>
</div>
</div>
<div class="section level2">
<h2 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h2>
<p>After drawing subsample, <code>ssp.relogit</code> utilizes
<code><a href="https://rdrr.io/pkg/survey/man/svyglm.html" class="external-link">survey::svyglm</a></code> to fit the model on the subsample, which
eventually uses <code>glm</code>. Arguments accepted by
<code>svyglm</code> can be passed through <code>...</code> in
<code>ssp.glm</code>.</p>
<p>Below is an example demonstrating the use of
<code>ssp.relogit</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n.plt</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="va">n.ssp</span> <span class="op">&lt;-</span> <span class="fl">600</span></span>
<span><span class="va">ssp.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ssp.relogit.html">ssp.relogit</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>,</span>
<span>                           data <span class="op">=</span> <span class="va">data</span>,</span>
<span>                           n.plt <span class="op">=</span> <span class="va">n.plt</span>,</span>
<span>                           n.ssp <span class="op">=</span> <span class="va">n.ssp</span>,</span>
<span>                           criterion <span class="op">=</span> <span class="st">'optA'</span>,</span>
<span>                           likelihood <span class="op">=</span> <span class="st">'logOddsCorrection'</span></span>
<span>                           <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="outputs">Outputs<a class="anchor" aria-label="anchor" href="#outputs"></a>
</h2>
<p>The returned object contains estimation results and indices of drawn
subsample in the full dataset.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ssp.results</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "model.call"            "coef.plt"              "coef.ssp"             </span></span>
<span><span class="co">#&gt;  [4] "coef"                  "cov.ssp"               "cov"                  </span></span>
<span><span class="co">#&gt;  [7] "index.plt"             "index"                 "N"                    </span></span>
<span><span class="co">#&gt; [10] "subsample.size.expect" "terms"</span></span></code></pre></div>
<p>Some key returned variables:</p>
<ul>
<li><p><code>index.plt</code> and <code>index</code> are the row indices
of drawn pilot subsamples and optimal subsamples in the full
data.</p></li>
<li><p><code>coef.ssp</code> is the subsample estimator for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
and <code>coef</code> is the linear combination of <code>coef.plt</code>
(pilot estimator) and <code>coef.ssp</code>.</p></li>
<li><p><code>cov.ssp</code> and <code>cov</code> are estimated
covariance matrices of <code>coef.ssp</code> and
<code>coef</code>.</p></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ssp.results</span><span class="op">)</span></span>
<span><span class="co">#&gt; Model Summary</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ssp.relogit(formula = formula, data = data, n.plt = n.plt, n.ssp = n.ssp, </span></span>
<span><span class="co">#&gt;     criterion = "optA", likelihood = "logOddsCorrection")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Subsample Size:</span></span>
<span><span class="co">#&gt;                                </span></span>
<span><span class="co">#&gt; 1       Total Sample Size 20000</span></span>
<span><span class="co">#&gt; 2 Expected Subsample Size   866</span></span>
<span><span class="co">#&gt; 3   Actual Subsample Size   886</span></span>
<span><span class="co">#&gt; 4   Unique Subsample Size   886</span></span>
<span><span class="co">#&gt; 5  Expected Subample Rate 4.33%</span></span>
<span><span class="co">#&gt; 6    Actual Subample Rate 4.43%</span></span>
<span><span class="co">#&gt; 7    Unique Subample Rate 4.43%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           Estimate Std. Error  z value Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; Intercept  -5.7329     0.1410 -40.6603  &lt;0.0001</span></span>
<span><span class="co">#&gt; V1         -0.4249     0.0895  -4.7460  &lt;0.0001</span></span>
<span><span class="co">#&gt; V2         -0.5991     0.1014  -5.9098  &lt;0.0001</span></span>
<span><span class="co">#&gt; V3         -0.3641     0.1030  -3.5336   0.0004</span></span>
<span><span class="co">#&gt; V4         -0.5157     0.0972  -5.3076  &lt;0.0001</span></span>
<span><span class="co">#&gt; V5         -0.4974     0.1032  -4.8182  &lt;0.0001</span></span>
<span><span class="co">#&gt; V6         -0.5034     0.0848  -5.9376  &lt;0.0001</span></span></code></pre></div>
<p>In the printed results, <code>Expected Subsample Size</code> is the
sum of rare event counts
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>N</mi><mn>1</mn></msub><annotation encoding="application/x-tex">N_{1}</annotation></semantics></math>)
and the expected size of negative subsample drawn from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>N</mi><mn>0</mn></msub><annotation encoding="application/x-tex">N_{0}</annotation></semantics></math>
non-rare observations. <code>Actual Subsample Size</code> is the sum of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>N</mi><mn>1</mn></msub><annotation encoding="application/x-tex">N_{1}</annotation></semantics></math>
and the actual size of negative subsample from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>N</mi><mn>0</mn></msub><annotation encoding="application/x-tex">N_{0}</annotation></semantics></math>
non-rare observations.</p>
<p>The coefficients and standard errors printed by
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> are <code>coef</code> and the square root of
<code>diag(cov)</code>.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-wang2021nonuniform" class="csl-entry">
Wang, HaiYing, Aonan Zhang, and Chong Wang. 2021. <span>“Nonuniform
Negative Sampling and Log Odds Correction with Rare Events Data.”</span>
<em>Advances in Neural Information Processing Systems</em> 34: 19847–59.
</div>
<div id="ref-wang2018optimal" class="csl-entry">
Wang, HaiYing, Rong Zhu, and Ping Ma. 2018. <span>“Optimal Subsampling
for Large Sample Logistic Regression.”</span> <em>Journal of the
American Statistical Association</em> 113 (522): 829–44.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Qingkai Dong, Yaqiong Yao, Haiying Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
